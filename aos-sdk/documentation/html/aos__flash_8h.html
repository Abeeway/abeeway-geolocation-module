<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Abeeway Geolocation Module SDK: aos-libs/aos-services/src/aos_flash.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Abeeway Geolocation Module SDK
   </div>
   <div id="projectbrief">A FreeRTOS based Software Development Kit for the Abeeway Geolocation Module</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_bbd625c80d66cf6285b9f7aba4ae7f44.html">aos-libs</a></li><li class="navelem"><a class="el" href="dir_66365b511f659fd25a9385b261199a3f.html">aos-services</a></li><li class="navelem"><a class="el" href="dir_41a8ec6f3fa8e9fad22126429ef51cc5.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">aos_flash.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Flash memory interface API.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="aos__common_8h_source.html">aos_common.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for aos_flash.h:</div>
<div class="dyncontent">
<div class="center"><img src="aos__flash_8h__incl.png" border="0" usemap="#aos-libs_2aos-services_2src_2aos__flash_8h" alt=""/></div>
<map name="aos-libs_2aos-services_2src_2aos__flash_8h" id="aos-libs_2aos-services_2src_2aos__flash_8h">
<area shape="rect" id="node2" href="aos__common_8h.html" title="Common definitions. " alt="" coords="23,95,133,121"/>
</map>
</div>
</div>
<p><a href="aos__flash_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:adb5d943cc0129f779bf707ea73c9cf4c"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aos__flash_8h.html#adb5d943cc0129f779bf707ea73c9cf4c">aos_flash_page_count</a> ()</td></tr>
<tr class="memdesc:adb5d943cc0129f779bf707ea73c9cf4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine the number of valid flash pages.  <a href="#adb5d943cc0129f779bf707ea73c9cf4c">More...</a><br /></td></tr>
<tr class="separator:adb5d943cc0129f779bf707ea73c9cf4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77cfe883718a84b5d524984d53fa3d27"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aos__flash_8h.html#a77cfe883718a84b5d524984d53fa3d27">aos_flash_page_size</a> ()</td></tr>
<tr class="memdesc:a77cfe883718a84b5d524984d53fa3d27"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine the flash page size.  <a href="#a77cfe883718a84b5d524984d53fa3d27">More...</a><br /></td></tr>
<tr class="separator:a77cfe883718a84b5d524984d53fa3d27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfff4d2e736e5731dbf6b9bf30966d9b"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aos__flash_8h.html#adfff4d2e736e5731dbf6b9bf30966d9b">aos_flash_page_address</a> (uint32_t page)</td></tr>
<tr class="memdesc:adfff4d2e736e5731dbf6b9bf30966d9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine the flash memory address of a flash page.  <a href="#adfff4d2e736e5731dbf6b9bf30966d9b">More...</a><br /></td></tr>
<tr class="separator:adfff4d2e736e5731dbf6b9bf30966d9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c4b532924cc4724dd3603fd5a3d3d9a"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aos__flash_8h.html#a4c4b532924cc4724dd3603fd5a3d3d9a">aos_flash_page_number</a> (uint32_t address)</td></tr>
<tr class="memdesc:a4c4b532924cc4724dd3603fd5a3d3d9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine the flash page number for a flash memory address.  <a href="#a4c4b532924cc4724dd3603fd5a3d3d9a">More...</a><br /></td></tr>
<tr class="separator:a4c4b532924cc4724dd3603fd5a3d3d9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f75fdb3871217075f6d891f882b0db2"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aos__flash_8h.html#a1f75fdb3871217075f6d891f882b0db2">aos_flash_page_offset</a> (uint32_t address)</td></tr>
<tr class="memdesc:a1f75fdb3871217075f6d891f882b0db2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine the offset in a flash page of a given flash memory address.  <a href="#a1f75fdb3871217075f6d891f882b0db2">More...</a><br /></td></tr>
<tr class="separator:a1f75fdb3871217075f6d891f882b0db2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7bbe3dfd4fae0da7fc6a98efabdcb3a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__aos__system.html#gad3ecdc146fcc76996620c96df43c1b3f">aos_result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aos__flash_8h.html#ac7bbe3dfd4fae0da7fc6a98efabdcb3a">aos_flash_erase_page</a> (uint32_t page, uint16_t npages)</td></tr>
<tr class="memdesc:ac7bbe3dfd4fae0da7fc6a98efabdcb3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Erase one or more flash pages.  <a href="#ac7bbe3dfd4fae0da7fc6a98efabdcb3a">More...</a><br /></td></tr>
<tr class="separator:ac7bbe3dfd4fae0da7fc6a98efabdcb3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a149fee39a9199cf5c6f90714a0fdb299"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__aos__system.html#gad3ecdc146fcc76996620c96df43c1b3f">aos_result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aos__flash_8h.html#a149fee39a9199cf5c6f90714a0fdb299">aos_flash_write_dword</a> (uint32_t address, uint64_t data)</td></tr>
<tr class="memdesc:a149fee39a9199cf5c6f90714a0fdb299"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write a double word (64 bits) to a flash memory address.  <a href="#a149fee39a9199cf5c6f90714a0fdb299">More...</a><br /></td></tr>
<tr class="separator:a149fee39a9199cf5c6f90714a0fdb299"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af71c5be998aa433fc026b0fb93649bb9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__aos__system.html#gad3ecdc146fcc76996620c96df43c1b3f">aos_result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aos__flash_8h.html#af71c5be998aa433fc026b0fb93649bb9">aos_flash_write_page</a> (unsigned dest_page, uint32_t src_addr)</td></tr>
<tr class="memdesc:af71c5be998aa433fc026b0fb93649bb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill a flash page with data from a memory area. This function is built upon <a class="el" href="aos__flash_8h.html#a149fee39a9199cf5c6f90714a0fdb299" title="Write a double word (64 bits) to a flash memory address. ">aos_flash_write_dword()</a>, and can be used to copy a RAM or FLASH memory area to a FLASH page.  <a href="#af71c5be998aa433fc026b0fb93649bb9">More...</a><br /></td></tr>
<tr class="separator:af71c5be998aa433fc026b0fb93649bb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Flash memory interface API. </p>
<p>This module provides an interface to flash memory, essentially intended for DFU / FUOTA purposes.</p>
<dl class="section note"><dt>Note</dt><dd>Write operations should be limited to the strict minimum to avoid deteriorating the FLASH memory, which is only guaranteed for 10000 erase/write cycles.</dd>
<dd>
For application data storage, prefer the aos_nvm API.</dd></dl>
<p>Created on: Jan 2, 2023 Author: marc</p>
<p>Copyright (C) 2023, Abeeway (www.abeeway.com). All Rights Reserved.</p>
<p>Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimers. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimers in the documentation and/or other materials provided with the distribution.</p>
<p>In no event shall the authors or copyright holders be liable for any special, incidental, indirect or consequential damages of any kind, or any damages whatsoever resulting from loss of use, data or profits, whether or not advised of the possibility of damage, and on any theory of liability, arising out of or in connection with the use or performance of this software.</p>
<p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE CONTRIBUTORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS WITH THE SOFTWARE </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ac7bbe3dfd4fae0da7fc6a98efabdcb3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7bbe3dfd4fae0da7fc6a98efabdcb3a">&#9670;&nbsp;</a></span>aos_flash_erase_page()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__aos__system.html#gad3ecdc146fcc76996620c96df43c1b3f">aos_result_t</a> aos_flash_erase_page </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>npages</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Erase one or more flash pages. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">page</td><td>The starting page number to erase. </td></tr>
    <tr><td class="paramname">npages</td><td>The number of pages to erase. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>aos_result_t indicating success or failure. </dd></dl>

</div>
</div>
<a id="adfff4d2e736e5731dbf6b9bf30966d9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfff4d2e736e5731dbf6b9bf30966d9b">&#9670;&nbsp;</a></span>aos_flash_page_address()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t aos_flash_page_address </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>page</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine the flash memory address of a flash page. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">page</td><td>A valid flash page number for which to determine the memory address. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A valid flash memory address, or 0 if an invalid page number was passed. </dd></dl>

</div>
</div>
<a id="adb5d943cc0129f779bf707ea73c9cf4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb5d943cc0129f779bf707ea73c9cf4c">&#9670;&nbsp;</a></span>aos_flash_page_count()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned aos_flash_page_count </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine the number of valid flash pages. </p>
<dl class="section return"><dt>Returns</dt><dd>The number of flash pages that exist on this MCU. </dd></dl>

</div>
</div>
<a id="a4c4b532924cc4724dd3603fd5a3d3d9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c4b532924cc4724dd3603fd5a3d3d9a">&#9670;&nbsp;</a></span>aos_flash_page_number()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t aos_flash_page_number </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>address</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine the flash page number for a flash memory address. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">address</td><td>A valid flash memory address for which to determine the page number. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The flash page number containing the address, or the value 0xffffffff if an invalid address was passed. </dd></dl>

</div>
</div>
<a id="a1f75fdb3871217075f6d891f882b0db2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f75fdb3871217075f6d891f882b0db2">&#9670;&nbsp;</a></span>aos_flash_page_offset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t aos_flash_page_offset </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>address</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine the offset in a flash page of a given flash memory address. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">address</td><td>A valid flash memory address for which to determine the page offset. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The offset within the flash page, or the value 0xffffffff if an invalid address was passed. </dd></dl>

</div>
</div>
<a id="a77cfe883718a84b5d524984d53fa3d27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77cfe883718a84b5d524984d53fa3d27">&#9670;&nbsp;</a></span>aos_flash_page_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned aos_flash_page_size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine the flash page size. </p>
<dl class="section return"><dt>Returns</dt><dd>The size of a flash page in bytes. </dd></dl>

</div>
</div>
<a id="a149fee39a9199cf5c6f90714a0fdb299"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a149fee39a9199cf5c6f90714a0fdb299">&#9670;&nbsp;</a></span>aos_flash_write_dword()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__aos__system.html#gad3ecdc146fcc76996620c96df43c1b3f">aos_result_t</a> aos_flash_write_dword </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write a double word (64 bits) to a flash memory address. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">address</td><td>A 64-bit aligned flash memory address </td></tr>
    <tr><td class="paramname">data</td><td>The 64-bit value to write </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>aos_result_t indicating success or failure. </dd></dl>

</div>
</div>
<a id="af71c5be998aa433fc026b0fb93649bb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af71c5be998aa433fc026b0fb93649bb9">&#9670;&nbsp;</a></span>aos_flash_write_page()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__aos__system.html#gad3ecdc146fcc76996620c96df43c1b3f">aos_result_t</a> aos_flash_write_page </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>dest_page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>src_addr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fill a flash page with data from a memory area. This function is built upon <a class="el" href="aos__flash_8h.html#a149fee39a9199cf5c6f90714a0fdb299" title="Write a double word (64 bits) to a flash memory address. ">aos_flash_write_dword()</a>, and can be used to copy a RAM or FLASH memory area to a FLASH page. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dest_page</td><td>destination flash page number </td></tr>
    <tr><td class="paramname">src_addr</td><td>The source address from where to copy the data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>aos_result_t indicating success or failure. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>The source address must be 32-bit aligned, as the data is read in 64-bit chunks. The destination page must have been previously erased. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
